{% extends "base.html" %} {% block content %}

<div
  class="min-h-screen bg-gradient-to-br py-8 px-4"
>
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-black mb-2">🌦️ Tra Cứu Thời Tiết</h1>
      <p class="text-black">Thông tin thời tiết chính xác và cập nhật</p>
    </div>

    <!-- Search Bar -->
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <form method="GET" action="/weather/search" class="flex gap-3">
        <input
          type="text"
          name="location"
          placeholder="Nhập tên thành phố hoặc địa điểm..."
          class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          required
        />
        <button
          type="submit"
          class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 font-medium"
        >
          🔍 Tìm kiếm
        </button>
      </form>
    </div>

    {% if results %}
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800">
            Kết quả cho "{{ location }}"
        </h2>

        <ul class="divide-y divide-gray-200">
            {% for r in results %}
            <li class="py-3 flex justify-between items-center hover:bg-gray-50 rounded-lg px-2">
                <div>
                <p class="font-medium text-lg text-gray-800">
                    {{ r.name }}, {{ r.country }}
                </p>
                <p class="text-sm text-gray-500">
                   {{r.admin1}} ({{ r.latitude }}, {{ r.longitude }})
                </p>
                </div>
                
               <a href="{{ url_for('weather.current', lat=r.latitude, lon=r.longitude, name=r.name) }}"
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
                >
                Xem thời tiết
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% elif not_found %}
    <div class="shadow-lg rounded-lg bg-white p-6 mb-6">
      <div class="flex justify-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" width="120" height="120">>
          <circle cx="60" cy="60" r="40" fill="none" stroke="black" stroke-width="3"/>
          <circle cx="48" cy="52" r="3" fill="black"/>
          <circle cx="72" cy="52" r="3" fill="black"/>
          <path d="M 45 75 Q 60 68, 75 75" fill="none" stroke="black" stroke-width="3" stroke-linecap="round"/>
          <circle cx="85" cy="85" r="8" fill="none" stroke="black" stroke-width="3"/>
          <line x1="91" y1="91" x2="100" y2="100" stroke="black" stroke-width="3" stroke-linecap="round"/>
          <line x1="82" y1="85" x2="88" y2="85" stroke="black" stroke-width="2"/>
        </svg>
      </div>
      <p class="text-center font-bold text-2xl text-red-600 mb-2">Không tìm thấy địa điểm "{{ location }}"</p>
      <p class="text-center text-gray-600">Vui lòng thử lại với tên khác hoặc kiểm tra chính tả</p>
    </div>
    {% elif weather %}
    <div class="bg-white shadow-lg rounded-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4 text-center">🌤️ Thông Tin Thời Tiết Hiện Tại</h2>

      <div class="grid grid-cols-2 gap-4 text-gray-700 mb-6">
        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">🌡️ Nhiệt độ:</span>
          <span>{{ weather.temperature }} °C</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">💧 Độ ẩm:</span>
          <span>{{ weather.humidity }} %</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">☁️ Mây bao phủ:</span>
          <span>{{ weather.cloud_cover }} %</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">🌧️ Lượng mưa:</span>
          <span>{{ weather.precipitation }} mm</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">🌦️ Khả năng mưa:</span>
          <span>{{ weather.rain }} %</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">💨 Tốc độ gió:</span>
          <span>{{ weather.wind_speed }} km/h</span>
        </div>
      </div>

      <h3 class="text-xl font-bold mb-3 text-center">🌫️ Chất Lượng Không Khí</h3>
      <div class="grid grid-cols-2 gap-4 text-gray-700">
        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">Mức độ ô nhiễm không khí:</span>
          <span>{{ weather.air_quality_index }}/500</span>
        </div>

        <div class="flex justify-between border-b py-2">
          <span class="font-semibold">Nồng độ bụi mịn trong không khí:</span>
          <span>{{ weather.pm2_5 }} µg/m³</span>
        </div>
      </div>
    </div>
    {% else %}
   <div class="shadow-lg rounded-lg bg-white p-6 mb-6">
  <div class="flex justify-center mb-4">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 120 120"
      width="120"
      height="120"
    >
      <!-- Land masses / continents -->
      <path
        d="M 15 40 Q 20 35, 30 38 L 35 42 Q 38 45, 42 43 L 48 40 Q 52 38, 55 42 L 58 48 Q 60 52, 65 50 L 70 47 Q 75 45, 78 48 L 82 52 Q 85 55, 90 53 L 95 50 Q 100 48, 105 52 L 105 85 L 15 85 Z"
        fill="none"
        stroke="black"
        stroke-width="2"
        stroke-linejoin="round"
      />
    
      <!-- Island 1 -->
      <ellipse
        cx="25"
        cy="25"
        rx="8"
        ry="6"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        transform="rotate(-15 25 25)"
      />
    
      <!-- Island 2 -->
      <path
        d="M 85 25 Q 88 22, 92 24 Q 95 26, 93 29 Q 90 31, 87 29 Q 84 27, 85 25 Z"
        fill="none"
        stroke="black"
        stroke-width="1.5"
      />
    
      <!-- Rivers -->
      <path
        d="M 45 50 Q 48 58, 50 65 Q 52 72, 55 78"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        opacity="0.6"
      />
    
      <path
        d="M 75 48 Q 72 55, 70 62 Q 68 68, 65 75"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        opacity="0.6"
      />
    
      <!-- Mountains (triangular peaks) -->
      <path
        d="M 30 55 L 33 48 L 36 55"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        stroke-linejoin="miter"
      />
      <path
        d="M 36 55 L 39 50 L 42 55"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        stroke-linejoin="miter"
      />
    
      <path
        d="M 80 60 L 83 53 L 86 60"
        fill="none"
        stroke="black"
        stroke-width="1.5"
        stroke-linejoin="miter"
      />
    
      <!-- Roads/Paths -->
      <path
        d="M 20 70 Q 35 68, 50 72 Q 65 75, 80 70 Q 90 67, 100 72"
        fill="none"
        stroke="black"
        stroke-width="1.2"
        opacity="0.5"
        stroke-dasharray="3,2"
      />
    
      <!-- Small trees/forest areas -->
      <circle
        cx="60"
        cy="68"
        r="2"
        fill="none"
        stroke="black"
        stroke-width="1"
        opacity="0.5"
      />
      <circle
        cx="63"
        cy="70"
        r="2"
        fill="none"
        stroke="black"
        stroke-width="1"
        opacity="0.5"
      />
      <circle
        cx="57"
        cy="70"
        r="2"
        fill="none"
        stroke="black"
        stroke-width="1"
        opacity="0.5"
      />
    
      <circle
        cx="28"
        cy="65"
        r="2"
        fill="none"
        stroke="black"
        stroke-width="1"
        opacity="0.5"
      />
      <circle
        cx="25"
        cy="67"
        r="2"
        fill="none"
        stroke="black"
        stroke-width="1"
        opacity="0.5"
      />
    
      <!-- Location pin centered (moved right) -->
      <path
        d="M 75 30 
         C 65 30, 60 35, 60 43
         C 60 53, 75 80, 75 80
         C 75 80, 90 53, 90 43
         C 90 35, 85 30, 75 30 Z"
        fill="white"
        stroke="black"
        stroke-width="3"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    
      <!-- Inner circle of pin (moved right) -->
      <circle
        cx="75"
        cy="43"
        r="6"
        fill="none"
        stroke="black"
        stroke-width="2.5"
      />
    
      <!-- Crosshair/target in the circle (moved right) -->
      <line
        x1="75"
        y1="37"
        x2="75"
        y2="49"
        stroke="black"
        stroke-width="1.5"
        stroke-linecap="round"
      />
      <line
        x1="69"
        y1="43"
        x2="81"
        y2="43"
        stroke="black"
        stroke-width="1.5"
        stroke-linecap="round"
      />
    </svg>
  </div>
  <p class="text-center font-bold text-2xl">Chọn 1 địa điểm để xem thời tiết</p>
</div>
    {% endif %}

    <!-- Footer Info -->
    <div class="text-center mt-8 text-white text-sm">
      <p>Dữ liệu từ Open-Meteo API • Cập nhật theo thời gian thực</p>
    </div>
  </div>
</div>

{% endblock %}